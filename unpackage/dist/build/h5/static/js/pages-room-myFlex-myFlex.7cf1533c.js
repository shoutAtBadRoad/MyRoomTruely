(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-room-myFlex-myFlex"],{"08d0":function(t,e,n){"use strict";n("caad"),n("a9e3"),n("ac1f"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o={props:{top:{type:Number,default:80},bottom:{type:Number,default:100},loadingText:{type:String,default:"正在刷新"},pullingText:{type:String,default:"下拉刷新"},releaseText:{type:String,default:"释放刷新"},scrollTop:Number,scrollIntoView:String,scrollWithAnimation:{type:Boolean,default:!0},enableBackToTop:Boolean,showBackTopButton:{type:Boolean,default:!0},showScrollbar:Boolean,enableFlex:Boolean,refresherEnabled:{type:Boolean,default:!0}},data:function(){return{touch:{start:0,move:0},scrollTop2:0,backTopButtonFadeIn:!1,status:"end"}},watch:{scrollTop:{immediate:!0,handler:function(t){this.scrollTop2=t||""}}},computed:{transform:function(){return this.touch.move?"translate3d(0, ".concat(this.touch.move,"px, 0)"):""},transition:function(){return["end","loading"].includes(this.status)?"transform 0.3s":""},isReleasable:function(){return this.touch.move>=this.top},text:function(){switch(this.status){case"pulling":return this.isReleasable?this.releaseText:this.pullingText;case"loading":return this.loadingText;default:return this.pullingText}}},methods:{onTouchStart:function(t){"end"==this.status&&this.refresherEnabled&&(this.touch.start=t.changedTouches[0].clientY,this.status="pulling")},onTouchMove:function(t){if("pulling"==this.status&&this.scrollTop2<=10){var e=t.changedTouches[0].clientY-this.touch.start;e<=200&&(this.touch.move=e)}},onTouchEnd:function(t){this.isReleasable?this.down():this.end()},onScroll:function(t){this.backTopButtonFadeIn=t.detail.scrollTop>=200,this.$emit("scroll",t)},down:function(){var t=this;uni.createSelectorQuery().in(this).select(".cl-scroller__loading").fields({size:!0},(function(e){t.status="loading",t.touch.move=e.height,t.$emit("down")})).exec()},up:function(){this.$emit("up")},end:function(){this.status="end",this.touch.move=0},scrollTo:function(t){this.scrollTop2=t},backTop:function(){this.scrollTop2=Math.random()}}};e.default=o},"0f5c":function(t,e,n){"use strict";n.r(e);var o=n("f652"),i=n.n(o);for(var s in o)"default"!==s&&function(t){n.d(e,t,(function(){return o[t]}))}(s);e["default"]=i.a},1608:function(t,e,n){"use strict";n("a9e3"),n("ac1f"),n("5319"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n("7395"),i={name:"cl-icon",props:{name:String,size:[String,Number],color:String},computed:{name2:function(){return this.name.replace("cl-icon-","")}},methods:{parseRpx:o.parseRpx}};e.default=i},"2d58":function(t,e,n){"use strict";n.r(e);var o=n("aea3"),i=n("0f5c");for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);var a,r=n("f0c5"),l=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],a);e["default"]=l.exports},"53b7":function(t,e,n){"use strict";n.r(e);var o=n("aa06"),i=n("dcc4");for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);var a,r=n("f0c5"),l=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],a);e["default"]=l.exports},"5ab4":function(t,e,n){"use strict";n.r(e);var o=n("5e60"),i=n("c1f0");for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);var a,r=n("f0c5"),l=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],a);e["default"]=l.exports},"5e60":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return o}));var o={clLoading:n("e082").default,clText:n("2d58").default,clIcon:n("53b7").default},i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"cl-scroller__wrap"},[n("v-uni-view",{staticClass:"cl-scroller__loading",style:{transform:t.transform,transition:t.transition}},[t._t("loading",["loading"==t.status?n("cl-loading",{attrs:{size:20}}):t._e(),n("cl-text",{attrs:{size:26,margin:[0,0,0,14],value:t.text}})],{text:t.text,status:t.status,move:t.touch.move})],2),n("v-uni-view",{staticClass:"cl-scroller",style:{transform:t.transform,transition:t.transition},on:{touchmove:function(e){arguments[0]=e=t.$handleEvent(e),t.onTouchMove.apply(void 0,arguments)},touchstart:function(e){arguments[0]=e=t.$handleEvent(e),t.onTouchStart.apply(void 0,arguments)},touchend:function(e){arguments[0]=e=t.$handleEvent(e),t.onTouchEnd.apply(void 0,arguments)}}},[n("v-uni-scroll-view",{staticClass:"cl-scroller__view",attrs:{"scroll-y":!0,"lower-top":t.bottom,"scroll-top":t.scrollTop2,"scroll-into-view":t.scrollIntoView,"scroll-with-animation":t.scrollWithAnimation,"enable-back-to-top":t.enableBackToTop,"show-scrollbar":t.showScrollbar,"enable-flex":t.enableFlex},on:{scroll:function(e){arguments[0]=e=t.$handleEvent(e),t.onScroll.apply(void 0,arguments)},scrolltolower:function(e){arguments[0]=e=t.$handleEvent(e),t.up.apply(void 0,arguments)}}},[t._t("default")],2)],1),t.showBackTopButton?n("v-uni-view",{staticClass:"cl-scroller__back-top",class:[{fadeIn:t.backTopButtonFadeIn}],on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.backTop.apply(void 0,arguments)}}},[n("cl-icon",{attrs:{name:"top",color:"#666"}}),n("v-uni-text",{staticClass:"cl-scroller__back-top-text"},[t._v("顶部")])],1):t._e()],1)},s=[]},"9dad":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return o}));var o={clScroller:n("5ab4").default},i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",[n("cl-scroller",{ref:"scroller",staticClass:"container",attrs:{bottom:0,"scroll-y":"true"},on:{down:function(e){arguments[0]=e=t.$handleEvent(e),t.onDown.apply(void 0,arguments)}}},t._l(t.items,(function(t,e){return n("v-uni-view",{key:e},[n("log",{attrs:{content:t.content,id:t.fromId}})],1)})),1)],1)},s=[]},a173:function(t,e,n){"use strict";n.r(e);var o=n("b42f"),i=n.n(o);for(var s in o)"default"!==s&&function(t){n.d(e,t,(function(){return o[t]}))}(s);e["default"]=i.a},aa06:function(t,e,n){"use strict";var o;n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return o}));var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-text",{class:["cl-icon","cl-icon-"+t.name2],style:{fontSize:t.parseRpx(t.size),color:t.color}})},s=[]},aea3:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return o}));var o={clIcon:n("53b7").default},i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"cl-text",class:[t.classList],style:{margin:t.parseRpx(t.margin),color:t.color,"font-size":"26rpx","letter-spacing":t.parseRpx(t.letterSpacing),"-webkit-line-clamp":t.ellipsis},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onTap.apply(void 0,arguments)}}},["price"==t.type?n("v-uni-text",{staticClass:"cl-text__symbol--price"},[t._v("￥")]):t._e(),t.prefixIcon?n("v-uni-text",{staticClass:"cl-text__prefix-icon"},[n("cl-icon",{attrs:{name:t.prefixIcon,size:t.fontSize}})],1):t._e(),n("v-uni-text",{staticClass:"cl-text__value",style:{fontSize:t.fontSize}},[t._v(t._s(t.d.value))]),"price"==t.type&&t.precision?n("v-uni-text",{staticClass:"cl-text__precision"},[t._v("."+t._s(t.d.precision))]):t._e(),t.suffixIcon?n("v-uni-text",{staticClass:"cl-text__suffix-icon"},[n("cl-icon",{attrs:{name:t.suffixIcon,size:t.fontSize}})],1):t._e()],1)},s=[]},b42f:function(t,e,n){"use strict";(function(t){var o=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("96cf");var i=o(n("1da1")),s=o(n("af50")),a=o(n("8bf1")),r={props:["chatId","frdId"],data:function(){return{socketTask:null,is_open_socket:!1,items:[],fresh:!0,myId:"",bottom:""}},methods:{init:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function n(){var o,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=uni.getStorageSync("user"),i=e,t("log",i.frdId," at pages/room/myFlex/myFlex.vue:33"),n.next=5,e.axios.request({url:"/msg/hist/"+i.frdId+"/"+o,method:"get",params:{}}).then((function(e){for(var n=e.data,o=0;o<n.length;o++)i.items.push(n[o]);0!=n?t("log","load success"," at pages/room/myFlex/myFlex.vue:46"):t("log","load fail"," at pages/room/myFlex/myFlex.vue:48")}));case 5:case"end":return n.stop()}}),n)})))()},onDown:function(){this.$refs.scroller.end()},getSrcList:function(e,n){var o={fromId:n,content:e};this.items.push(o);var s={fromId:this.myId,toId:this.frdId,content:e};s=JSON.stringify(s),t("log",s," at pages/room/myFlex/myFlex.vue:66"),this.socketTask.send({data:s,success:function(){return(0,i.default)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t("log","消息发送成功"," at pages/room/myFlex/myFlex.vue:70");case 1:case"end":return e.stop()}}),e)})))()}})},connectSocketInit:function(){var e=this,n=this;this.socketTask=uni.connectSocket({url:"ws://106.15.170.74:8082/webSocket/"+n.chatId,success:function(e){t("log","websocket连接成功"," at pages/room/myFlex/myFlex.vue:84")}}),this.socketTask.onOpen((function(n){t("log","WebSocket连接正常打开中...！"," at pages/room/myFlex/myFlex.vue:90"),e.is_open_socket=!0})),this.socketTask.onClose((function(){t("log","已经被关闭了"," at pages/room/myFlex/myFlex.vue:96")})),this.socketTask.onMessage((function(e){t("log","接收到消息："+e.data," at pages/room/myFlex/myFlex.vue:99"),t("log","来方："+e.data.fromId," at pages/room/myFlex/myFlex.vue:100"),t("log","自己："+n.myId," at pages/room/myFlex/myFlex.vue:101");var o=JSON.parse(String(e.data));String(o.fromId)!=String(n.myId)?n.items.push({fromId:o.fromId,content:o.content}):(t("log","自己的消息"," at pages/room/myFlex/myFlex.vue:109"),n.items.push({fromId:n.myId,content:o.content}))}))},closeSocket:function(){this.socketTask.close({success:function(e){this.is_open_socket=!1,t("log","关闭成功",e," at pages/room/myFlex/myFlex.vue:122")},fail:function(e){t("log","关闭失败",e," at pages/room/myFlex/myFlex.vue:125")}})},clickRequest:function(){this.is_open_socket&&this.socketTask.send({data:"请求一次发送一次message",success:function(){return(0,i.default)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t("log","消息发送成功"," at pages/room/myFlex/myFlex.vue:135");case 1:case"end":return e.stop()}}),e)})))()}})}},watch:{items:function(t,e){t&&(this.items=t,this.fresh=!1,this.fresh=!0)}},created:function(){},mounted:function(){this.myId=uni.getStorageSync("user"),this.init(),this.connectSocketInit()},beforeUpdate:function(){t("log","list before update"," at pages/room/myFlex/myFlex.vue:161")},updated:function(){t("log","list updated"," at pages/room/myFlex/myFlex.vue:165")},beforeDestroy:function(){},components:{log:s.default,inputBox:a.default}};e.default=r}).call(this,n("0de9")["log"])},c1f0:function(t,e,n){"use strict";n.r(e);var o=n("08d0"),i=n.n(o);for(var s in o)"default"!==s&&function(t){n.d(e,t,(function(){return o[t]}))}(s);e["default"]=i.a},d050:function(t,e,n){"use strict";var o=n("fb41"),i=n.n(o);i.a},d86c:function(t,e,n){"use strict";n.r(e);var o=n("9dad"),i=n("a173");for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);n("d050");var a,r=n("f0c5"),l=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,"e3829d36",null,!1,o["a"],a);e["default"]=l.exports},db11:function(t,e,n){var o=n("24fb");e=o(!1),e.push([t.i,".container[data-v-e3829d36]{position:absolute;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;\n        /* justify-content: flex-start; */-webkit-box-align:start;-webkit-align-items:flex-start;align-items:flex-start;background-color:#f3f3f3;width:100vw;height:87vh}",""]),t.exports=e},dcc4:function(t,e,n){"use strict";n.r(e);var o=n("1608"),i=n.n(o);for(var s in o)"default"!==s&&function(t){n.d(e,t,(function(){return o[t]}))}(s);e["default"]=i.a},f652:function(t,e,n){"use strict";var o=n("4ea4");n("a15b"),n("a9e3"),n("b680"),n("acd8"),n("ac1f"),n("1276"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o(n("3835")),s=n("7395"),a={name:"cl-text",props:{value:[String,Number],type:{type:String,default:"text"},encrypt:{type:Boolean,default:!0},bold:Boolean,block:Boolean,ellipsis:Number,color:{type:String,default:"#444"},size:{type:[String,Number],default:24},precision:{type:Boolean,default:!0},lineThrough:Boolean,underline:Boolean,letterSpacing:{type:[String,Number],default:0},margin:[String,Number,Array],prefixIcon:String,suffixIcon:String,copy:Boolean},computed:{d:function(){if("price"==this.type){var t=parseFloat(this.value||0).toFixed(2).split("."),e=(0,i.default)(t,2),n=e[0],o=e[1],s=void 0===o?"00":o;return this.precision?{value:n,precision:s}:{value:n}}if("phone"==this.type){var a=String(this.value);return{value:this.encrypt?a.substr(0,3)+"****"+a.substr(7):a}}return{value:this.value}},fontSize:function(){return(0,s.parseRpx)(this.size)},classList:function(){var t=[];return this.bold&&t.push("is-bold"),this.block&&t.push("is-block"),this.lineThrough&&t.push("is-line-through"),this.underline&&t.push("is-underline"),this.ellipsis>0&&t.push("is-ellipsis"),this.type&&t.push("is-".concat(this.type)),this.color&&t.push("is-color-".concat(this.color)),this.copy&&t.push("is-copy"),t.join(" ")}},methods:{parseRpx:s.parseRpx,onTap:function(t){this.$emit("click",t),this.$emit("tap",t)}}};e.default=a},fb41:function(t,e,n){var o=n("db11");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var i=n("4f06").default;i("192a64d0",o,!0,{sourceMap:!1,shadowMode:!1})}}]);